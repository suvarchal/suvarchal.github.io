import{o as a,b as i,w as s,g as e,ag as r,v as u,x as m,T as t}from"./modules/vue-CoEReDeK.js";import{I as p}from"./two-cols-0E-I6KTR.js";import{K as c,al as d}from"./index-DNgVCi0l.js";import"./ScholarlyHeader.vue_vue_type_script_setup_true_lang-BAbqk7Ew.js";import"./useFontSizeStyles-CeZIBkDH.js";import"./modules/shiki-dWneNDnB.js";const f="/clidyn2402/assets/gpu_all_scaling-B_I83_JB.png",v={__name:"slides.md__slidev_12",setup(C){const{$clicksContext:o,$frontmatter:n}=c();return o.setup(),(g,l)=>(a(),i(p,u(m(t(d)(t(n),11))),{right:s(h=>[...l[0]||(l[0]=[e("ul",null,[e("li",null,"Surprisingly fortran SCC kernels tuned for massive parallism dont scale."),e("li",null,"C++/Kokkos that used nproma style kernel, more columns for a gpu thread, scales much better."),e("li",null,"Not enough compute intensity per thread for this dwarf."),e("li",null,"Clearly Microphysics Dwarf is memory bound."),e("li",null,"Jax designed for massively problems also doesn’t scale and OOMs out. Test with SCC like kernel.")],-1)])]),default:s(()=>[l[1]||(l[1]=e("p",null,[e("img",{src:f,alt:"CLOUDSC Kernel — GPU Scaling Comparison"})],-1)),l[2]||(l[2]=e("ul",null,[e("li",null,[r("Fortran reference "),e("code",null,"cloudsc_gpu"),r(" has ~11 reference implementations using openACC that use SCC kernel.")]),e("li",null,"SCC: single column coalased makes sure that each GPU thread gets one column, massively parallel. This is unlike CPU kernels where each cpu-thread processes NPROMA number of columns."),e("li",null,"Select top 2 performing fortran SCC kernels as reference.")],-1))]),_:1},16))}};export{v as default};
